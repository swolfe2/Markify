kind: AdaptiveDialog
beginDialog:
  kind: OnConversationStart
  id: start
  actions:
    - kind: SendActivity
      id: send_welcome_card
      activity:
        attachmentLayout: List
        attachments:
          - kind: AdaptiveCardTemplate
            cardContent: |-
              {
                "$schema": "https://adaptivecards.io/schemas/adaptive-card.json",
                "type": "AdaptiveCard",
                "version": "1.5",
                "body": [
                  { 
                    "type": "TextBlock",
                    "text": "Hello, I'm **VizBot**. I help with all things Power BI at Kimberly-Clark.",
                    "wrap": true
                  },
                  { 
                    "type": "TextBlock",
                    "text": "I start with **Power BI Central** for K-C guidance and add trusted sources like Microsoft Learn and SQLBI when needed.",
                    "wrap": true,
                    "spacing": "Small"
                  },
                  { 
                    "type": "TextBlock",
                    "text": "Choose a prompt below â€” or type your own question:",
                    "wrap": true,
                    "weight": "Bolder",
                    "spacing": "Medium"
                  }
                ],
                "actions": [
                  {
                    "type": "Action.Submit",
                    "title": "How do I get a PBI Pro license?",
                    "data": "How do I get a PBI Pro license?"
                  },
                  {
                    "type": "Action.Submit",
                    "title": "Get access to a report / workspace",
                    "data": "How do I get access to a Power BI report / Workspace?"
                  },
                  {
                    "type": "Action.Submit",
                    "title": "Let others use my model",
                    "data": "How can others use the model I've built for their reports?"
                  },
                  {
                    "type": "Action.Submit",
                    "title": "Technical help and support",
                    "data": "How do I get technical help and support?"
                  },
                  {
                    "type": "Action.Submit",
                    "title": "Fix report performance",
                    "data": "How do I address performance issues in my report?"
                  }
                ]
              }
    - kind: Question
      id: question_after_card
      interruptionPolicy:
        allowInterruptions: true
      variable: Topic.UserResponse
      prompt: ""
      entity:
        kind: EmbeddedEntity
    - kind: ConditionGroup
      id: check_response_type
      conditions:
        - id: when_button_clicked
          condition: =!IsBlank(Topic.UserResponse)
          actions:
            - kind: AnswerQuestionWithAI
              id: answer_from_button
              userInput: =Text(Topic.UserResponse)
        - id: when_no_response
          condition: =IsBlank(Topic.UserResponse)
          actions:
            - kind: SendActivity
              id: prompt_again
              activity: Please choose one of the options above or type your question.
