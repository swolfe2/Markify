kind: AdaptiveDialog
beginDialog:
  kind: OnConversationStart
  id: start
  actions:
    - kind: AdaptiveCardPrompt
      id: ac_welcome
      card: |-
        {
          "$schema": "https://adaptivecards.io/schemas/adaptive-card.json",
          "type": "AdaptiveCard",
          "version": "1.5",
          "body": [
            { "type": "TextBlock",
              "text": "Hello, I'm **VizBot**. I help with all things Power BI at Kimberly-Clark.",
              "wrap": true
            },
            { "type": "TextBlock",
              "text": "I start with **Power BI Central** for K-C guidance and add trusted sources like Microsoft Learn and SQLBI when needed.",
              "wrap": true,
              "spacing": "Small"
            },
            { "type": "TextBlock",
              "text": "Choose a prompt below â€” or type your own and submit:",
              "wrap": true,
              "weight": "Bolder",
              "spacing": "Medium"
            },
            {
              "type": "Input.Text",
              "id": "userText",
              "placeholder": "Type your question (e.g., How do I request PBI Pro?)"
            }
          ],
          "actions": [
            {
              "type": "Action.Submit",
              "title": "How do I get a PBI Pro license?",
              "associatedInputs": "none",
              "data": { "prompt": "How do I get a PBI Pro license?" }
            },
            {
              "type": "Action.Submit",
              "title": "Get access to a report / workspace",
              "associatedInputs": "none",
              "data": { "prompt": "How do I get access to a Power BI report / Workspace?" }
            },
            {
              "type": "Action.Submit",
              "title": "Let others use my model",
              "associatedInputs": "none",
              "data": { "prompt": "How can others use the model I've built for their reports?" }
            },
            {
              "type": "Action.Submit",
              "title": "Technical help and support",
              "associatedInputs": "none",
              "data": { "prompt": "How do I get technical help and support?" }
            },
            {
              "type": "Action.Submit",
              "title": "Fix report performance",
              "associatedInputs": "none",
              "data": { "prompt": "How do I address performance issues in my report?" }
            },
            {
              "type": "Action.Submit",
              "title": "Ask this",
              "tooltip": "Submit the free-text field above"
            }
          ]
        }
      output:
        binding:
          prompt: Topic.SelectedPrompt
          userText: Topic.TypedPrompt

      outputType:
        properties:
          prompt: String
          userText: String

    - kind: SetVariable
      id: set_query
      variable: Topic.Query
      value: =Coalesce(Topic.SelectedPrompt, Topic.TypedPrompt)

    - kind: ConditionGroup
      id: branch_on_query
      conditions:
        - id: when_query_present
          condition: =!IsBlank(Topic.Query)
          actions:
            - kind: AnswerQuestionWithAI
              id: answer_ai
              userInput: =Topic.Query

        - id: when_query_blank
          condition: =IsBlank(Topic.Query)
          actions:
            - kind: SendActivity
              id: nudge_user
              activity: Please click a prompt or type into the field and press Ask this.